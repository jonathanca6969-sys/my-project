<Page x:Class="TurretApp.Views.TonnagePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{StaticResource BgBrush}">
    <Grid Margin="24,16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Row 0: Header -->
        <TextBlock Grid.Row="0" Text="TONNAGE  CALCULATION  ENGINE"
                   FontSize="22" FontWeight="Bold" FontFamily="{StaticResource TerminalFont}"
                   Foreground="{StaticResource AccentBrush}" HorizontalAlignment="Center"
                   Margin="0,0,0,16"/>

        <!-- Row 1: Top 3-column panel -->
        <Grid Grid.Row="1" Margin="0,0,0,14">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="1.2*"/>
                <ColumnDefinition Width="12"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT: Material + Thickness -->
            <Border Grid.Column="0" Style="{StaticResource SectionPanel}">
                <StackPanel>
                    <TextBlock Text="MATERIAL SELECTION" FontSize="11" Foreground="{StaticResource TextMutedBrush}"
                               HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <ComboBox x:Name="CboMaterial" SelectionChanged="OnGlobalInputChanged"
                              FontSize="13" Padding="8,6"/>

                    <TextBlock Text="MATERIAL THICKNESS (MILLIMETERS)" FontSize="11" Foreground="{StaticResource TextMutedBrush}"
                               HorizontalAlignment="Center" Margin="0,14,0,6"/>
                    <TextBox x:Name="TxtThickness" TextChanged="OnGlobalInputChanged"
                             FontSize="18" HorizontalContentAlignment="Center" Padding="8,8"/>
                </StackPanel>
            </Border>

            <!-- CENTER: Total Peak Hit Load -->
            <Border Grid.Column="2" Style="{StaticResource ResultDisplayPanel}">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="TOTAL PEAK HIT LOAD" FontSize="11" Foreground="{StaticResource TextMutedBrush}"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="TxtPeakLoad" Text="0.00" FontSize="52" FontWeight="Bold"
                               Foreground="{StaticResource AccentBrightBrush}" FontFamily="{StaticResource TerminalFont}"
                               HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    <TextBlock x:Name="TxtUnitLabel" Text="METRIC TONNES" FontSize="11" Foreground="{StaticResource TextMutedBrush}"
                               HorizontalAlignment="Center" Margin="0,2,0,6"/>
                    <TextBlock x:Name="TxtCapacityPct" Text="0.0% OF MACHINE CAPACITY" FontSize="13"
                               Foreground="{StaticResource AccentBrush}" FontFamily="{StaticResource TerminalFont}"
                               HorizontalAlignment="Center" FontWeight="SemiBold"/>
                </StackPanel>
            </Border>

            <!-- RIGHT: Machine Capacity + Multiplier + Units -->
            <Border Grid.Column="4" Style="{StaticResource SectionPanel}">
                <StackPanel>
                    <TextBlock Text="MACHINE CAPACITY LIMIT (METRIC TONNES)" FontSize="10" Foreground="{StaticResource TextMutedBrush}"
                               HorizontalAlignment="Center" Margin="0,0,0,6" TextWrapping="Wrap" TextAlignment="Center"/>
                    <TextBox x:Name="TxtMachineCapacity" Text="20" TextChanged="OnGlobalInputChanged"
                             FontSize="18" HorizontalContentAlignment="Center" Padding="8,8"/>

                    <Grid Margin="0,12,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="10"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="MATERIAL MULTIPLIER" FontSize="9" Foreground="{StaticResource TextMutedBrush}"
                                       HorizontalAlignment="Center" Margin="0,0,0,4"/>
                            <Border Background="{StaticResource BgInputBrush}" BorderBrush="{StaticResource BorderBrush}"
                                    BorderThickness="2" CornerRadius="2" Padding="6,6">
                                <TextBlock x:Name="TxtMultiplier" Text="1.00x" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource AccentBrightBrush}" FontFamily="{StaticResource TerminalFont}"
                                           HorizontalAlignment="Center"/>
                            </Border>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="UNIT SYSTEM" FontSize="9" Foreground="{StaticResource TextMutedBrush}"
                                       HorizontalAlignment="Center" Margin="0,0,0,4"/>
                            <ComboBox x:Name="CboUnits" SelectionChanged="OnGlobalInputChanged" FontSize="12" Padding="6,6">
                                <ComboBoxItem Content="Metric" Tag="MT" IsSelected="True"/>
                                <ComboBoxItem Content="Imperial" Tag="ST"/>
                            </ComboBox>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Row 2: Capacity Bar -->
        <Border Grid.Row="2" Style="{StaticResource SectionPanel}" Padding="16,10" Margin="0,0,0,14">
            <StackPanel>
                <Grid x:Name="CapacityBarContainer" Height="20" SizeChanged="OnCapacityBarSizeChanged">
                    <Border Background="{StaticResource BgTertiaryBrush}" CornerRadius="3"/>
                    <Border x:Name="CapacityBar" Background="{StaticResource AccentBrush}" CornerRadius="3"
                            HorizontalAlignment="Left" Width="0"/>
                    <Border x:Name="CapacityMarker" Width="2" Background="{StaticResource TextBrush}"
                            HorizontalAlignment="Left"/>
                </Grid>
                <Grid Margin="0,4,0,0">
                    <TextBlock Text="0% START" FontSize="10" Foreground="{StaticResource TextMutedBrush}" HorizontalAlignment="Left"/>
                    <TextBlock Text="CAPACITY LIMIT MARKER" FontSize="10" Foreground="{StaticResource TextMutedBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="100% OVERLOAD" FontSize="10" Foreground="{StaticResource TextMutedBrush}" HorizontalAlignment="Right"/>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Row 3: Column group headers + Add button -->
        <Grid Grid.Row="3" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1.1*"/>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="1.5*"/>
                <ColumnDefinition Width="2.5*"/>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="PUNCH SHAPE" Style="{StaticResource ColumnGroupHeader}" VerticalAlignment="Center" Margin="4,0,0,0"/>
            <TextBlock Grid.Column="1" Text="PHYSICAL DIMENSIONS" Style="{StaticResource ColumnGroupHeader}" VerticalAlignment="Center" Margin="4,0,0,0"/>
            <TextBlock Grid.Column="2" Text="CLUSTER CONFIGURATION" Style="{StaticResource ColumnGroupHeader}" VerticalAlignment="Center" Margin="4,0,0,0"/>
            <TextBlock Grid.Column="3" Text="TOOLING PARAMETERS" Style="{StaticResource ColumnGroupHeader}" VerticalAlignment="Center" Margin="4,0,0,0"/>
            <TextBlock Grid.Column="4" Text="HIT LOAD" Style="{StaticResource ColumnGroupHeader}" VerticalAlignment="Center" Margin="4,0,0,0"/>
            <Button Grid.Column="5" Content="+ ADD PIN SIZE/TYPE" Click="OnAddPunch" Padding="16,6" FontSize="12"/>
        </Grid>

        <!-- Row 4: Punch rows (scrollable) -->
        <ScrollViewer Grid.Row="4" VerticalScrollBarVisibility="Auto">
            <StackPanel x:Name="PunchRowsPanel"/>
        </ScrollViewer>
    </Grid>
</Page>
